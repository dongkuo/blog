<!--微信公众号-->
<script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
<script>
  function defaultWxShare() {
    let firstImg = document.querySelector('main img') || document.querySelector('body img')
    let imgUrl = firstImg && firstImg.src ? firstImg.src : window.location.origin + '/static/img/logo.jpg'
    return {title: window.document.title, link: window.location.href, imgUrl};
  }

  axios.get(`https://chuandaoshi.cn/api/weixin/signature?url=${encodeURIComponent(window.location.href)}`)
    .then(resp => {
      wx.config({
        debug: false,
        appId: resp.data.data.appId,
        timestamp: resp.data.data.timestamp,
        nonceStr: resp.data.data.nonceStr,
        signature: resp.data.data.signature,
        jsApiList: ['onMenuShareAppMessage','onMenuShareTimeline', 'onMenuShareQQ', 'onMenuShareQZone']
      });
      wx.ready(function () {   //需在用户可能点击分享按钮前就先调用
        wx.onMenuShareAppMessage({
          title: 'hello', // 分享标题
          desc: '11111', // 分享描述
          link: 'https://derker.site', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
          imgUrl: 'https://derker.site/static/img/logo.jpg', // 分享图标
          success: function () {
            // 设置成功
          }
        })

        wx.onMenuShareTimeline({
          title: 'hello', // 分享标题
          link: 'https://derker.site', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
          imgUrl: 'https://derker.site/static/img/logo.jpg', // 分享图标
          success: function () {
            // 设置成功
          }
        });

      });

      // wx.ready(function () {
      //   let wxShare = typeof window.wxShare === 'undefined' ? defaultWxShare() : window.wxShare
      //   wx.updateAppMessageShareData(wxShare);
      //   wx.updateTimelineShareData(wxShare);
      // });
      // wx.error(function (res) {
      // });
    })
    .catch(err => {
    })
</script>